var pr=Object.defineProperty;var hr=(t,e,o)=>e in t?pr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var D=(t,e,o)=>(hr(t,typeof e!="symbol"?e+"":e,o),o);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const q of document.querySelectorAll('link[rel="modulepreload"]'))i(q);new MutationObserver(q=>{for(const l of q)if(l.type==="childList")for(const x of l.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&i(x)}).observe(document,{childList:!0,subtree:!0});function o(q){const l={};return q.integrity&&(l.integrity=q.integrity),q.referrerPolicy&&(l.referrerPolicy=q.referrerPolicy),q.crossOrigin==="use-credentials"?l.credentials="include":q.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(q){if(q.ep)return;q.ep=!0;const l=o(q);fetch(q.href,l)}})();const It=document.getElementById("loadingScreen"),Ue=document.getElementById("loadingScreenClickText"),mr=()=>{It.classList.add("finish")},fr=()=>{It.classList.remove("finish")},Se=t=>{Ue.textContent=t},Vt=()=>{It.classList.add("hide")},ko=()=>{It.classList.remove("hide")},xe=()=>{Ue.classList.remove("hide")},yr=()=>{Ue.classList.add("hide")},gr=()=>{It.remove()},vr="data:audio/mpeg;base64,SUQzBAAAAAAAflRYWFgAAAASAAADbWFqb3JfYnJhbmQAaXNvbQBUWFhYAAAAEwAAA21pbm9yX3ZlcnNpb24ANTEyAFRYWFgAAAAYAAADY29tcGF0aWJsZV9icmFuZHMAbXA0MQBUU1NFAAAADwAAA0xhdmY1OC43Ni4xMDAAAAAAAAAAAAAAAP/7UMQAAAAAAAAAAAAAAAAAAAAAAEluZm8AAAADAAAADAAACpwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAExhdmM1OC4xMwAAAAAAAAAAAAAAACQGOQAAAAAAAArzAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/+1LE0QANKUs5rDEE4WsUaHT0DpDRwJTrsceRMNmsNqHR0gNj0wJDeqqy122WSxVutxJoxFENhC1yzNohgRyHiPs/FX4zBZNpUxJU1Mx2koSw+FxFzxkJcNhkkzm5upAOQJsSgn6Evn0mW6agqoSMfB9CXfUm1Bbm6BKGRIkkXxIqo2v7smMAdNi4Tis41temn+tO6alqPsYf703/qqSacNHQOkut01up+1GhprS6mZaLdA0QspkFuX0hLu8S7SyLQ2gQE5Q09GZS7gtB1omsKP/7UsTNABIpjUcsMRRBhDHp8pJwAE1z4f7kR1TLbUqlZK//5W/M///qVv//ym6s/1Y2Yj/X5jHbNVvL6iKB5pRAAnLU0ztVqtsJOKs1w6KkSgiKmEh5DCYodypGdZZogimdiBBBgeGg1noSASsCg2uIhORsiCCazadddAK06LoKgq4kGsjgq4UBXYp4KjXa6gq1B3/ke2I5ZJalep8yCv5V2wkDVTRg4PXEXG5nIm7bIAUYi7LAXVWH4ZpvIaQsAGFOqemHKdiY0gtg6aDCJ+Pz//tSxLGAEi2TYbj2gBlrsa//nlAHNy9hr18uFPteckWGz1r9jYeJbg8aSIgercWd////9X/9fHYsCtO8FoD5ZISjIL2hBzoYdgvwrTVb0a29DG5ee2phlpDitg+QgW5ukTE+azjSluJy+gpC42HEgsFn+KoLBAOnfz2tnKzue867SebVhIeWT/z2LurLJeAckISzlsjBcCkehHRAoLoSyDrBqVikOgjpp7Ez1bmysur82tYRywkBnabNplYcX0ZXOrzq/7C1BCWd5m/yYhH5lp7/+1LEmQAJ6DdT5iRlQTKP6zT0mWJ35fq5H+vRWXnb9smxGwQBA/HmuWMfe1aFarV9zYV6ymrGvT5dwmJ6UBLlernuIEY2W8ACT2kbQZH7LX3q8/EUG2czZMh3QlTpoyf/fbVz/3owIjN/0Z3SEBV0MS7+ICgSFCAQqrCcwToTAWEMmCM1a73SRp+x2cm2xojycqLVyZBtOYyR6vuubcvRBdBlGzamR2abFrf+luxPt+XXdrVZ76mHWvAMHOpG5tlohPy9ZGqtqWWqRqJIJGwKk//7UsSpAApYcT1HoPKBSKjoNMGKjMESIfGRTMu1IZkIq8saSwN7k4YxNodwCf/nE0RC/pnbMoia3/5BAAAdznObzT7Iydf/1Vvt9q22I3nP5Fd5AtM86JwjqdLj6o2ojSQILZIaIQcLA0QCQmF8raNf+JKcFHd5LNG2K796O1zb+ZBSpXp6+GBCzPvVtkd6qyL9/6fanZG6g0d6Gf7H87MzOcgN1MEcmHmLFMqOk3Y5doZG2UCFJGTB2ZiMjFZOPiOqHpMYEK1vk7XtiAQVoynd//tSxLSACgE7NKeEVEFFJ+ewkJaYmFZw/V3sEuPJfsid+ltar9hRGOtVYv6IX///q33r0Vvm+T4MtNRQ773+KKoQ1aMtbXdvFIlEkAV5iUEUQGSMVAQuE3giAgZW9C4YpSSoSge/yt9l0sCK7+6gLnRiTmV8qUOYSLZ81X/PvS3d/rLS3+vn+30+oMhdlGGp7/9SX0XTV/eldQACwYkkysChPCULLAloCt6kRW/YGp2wo1TkTqv6ZNa+W1SjK5RfpxYhLMp+2+sxUfv6K9vW/v//+1LEwYAKYT1HpIyxgUQoKKyTCPCnVm/ZO5T97P3Kr6q/cgDnoe2hNetGp4p3eIcikUCQCPwvJMifKITlWmmcC7OROKxKL6PZc3hKT8glitoTIjELzpPZke/cOAFR/X1frMnv7zOktWk2f9EXOv7Omn+3r+wFWyBjliO6zWqIZZeIZF2sTSDJwT5kJUuiYj1rtRIpOUckyrDnnevo5F2JjbPTLN8yTONOTZUMJlQxzm86m/t77qxU6U7W31E+n/+/3/Xqv9/o3QEDG6fSDuKmEv/7UsTNgApdP0emDFFBPyfpdJMJMCbHWBbMgAcEpYDFEEQmgwQAkNRxPiCCapKpeq4rhdQyQmimedNBKOV7Nn4ybcc+BiRz7Abf7eQV4f1p0yaKczKDn6fXVs7b2et72IzqyK/Eit4yU0YEh4i1HOxfMr7FR/ZfUct1h52lSSNsixkWsga54FhQlQmXlhSUyKUTk3++mOdSAAEGQ5Dsg8JWa6A6+10aNQTQxIVL8uKz7XYTQIn0fbaWugwPo+9veuqnbz/spdN/dvqZC1MJD84r//tSxNoAClE/R4eYrUFHp6m88YoIcEw0WZPD3LIxxOKsxRNNAg73x2l9L4AKylKo60KgRtO0cjkKvjBjGCQskggCCCORhhzbfmpRq90uN/dbMQUPpZEWlHagxRQj1d4puMdmYYWj9X/ofIZ/7a0b9/RvExA7XOGiNmdVMCUjgEijRAOC2m4YuhPQ5VK4mOQk4G8YaDaa5zIu4UPZuIxwd5+BRDBg01TOU0ONG136gNgSvmzG4bwwsOzPLYuh3ap8tdL/mfq/6fRu/6N9h31QKJb/+1LE5YAKSUFL55hOwZKwJzDBlqjD2gUnkPAAA9jpOBrO80SyFkXKsRiuTBBSeF8i3/YoylVyfRLpQYhSYiQI6F2Ic6nYYE92Y6uiPOOvprRrXIEYGD5KH60sz1psRveq823Z0ac6oRlOf6L13AwzPl5AkHpnBWPfgqpwlR1A2OJIAE54SgC2BwKyqLSR5SuJcRwpX9AittxQ/GrdfaWOunJYVmnI4JLMUMUHgk6rELWKlRz+X8SOADpk6W/dFml1n0X9Dvu32Zn+jPpf3/F3o//7UsToAAwNQT2njLFBc6endPMV6RxcHe99Rt1hCUgOBEEAHaK4dw3DmQSASKwo1ncQkT5GpeL5GrV1xCZ2OW1bJaZgAsB7wESka/nT2EiBJGkSk9KtSKxGGrN6+hlWOzqaHffMSl/7aU0qqeh/oJh0nnmBgpyg98hVRITcQNuKAeDoeC5KCwtw7K4kFI0KqcmILkWG1VkQ5mPrdaXu21nuk5OYzJmgOJKhCbYVbo24igs3Vio7FtR2zS6t+lqoMf70ejDPMdPS3i4oryFBr5ZA//tSxOcACwlBN6eMVMGMqSXk8SLx36AQlB15ATCW0QOc4ZDgoX07YEE6konmb5gMDpuV6tFeMaPfL9g85hrF1aiVZrmMMBdBblbS3bK12xKEImriW+9ou9WvH7f8/+u30/181TX8FVtMfcezf+KiGg+rKAUF78lh+uD1EILC/+kjLC6OF4CQBBhdlYaw9NNpx9MDNyTIR4sHA5CAGBiqunpeyhy2iOzPScjljwHF3NZaWobayS1HVTsY+6Oj6uq9zfq1atWl6PQok1VKUv9vFms=";class Ze{constructor(e){D(this,"source");D(this,"isPlaying");this.source=new Audio,this.source.src=e,this.isPlaying=!1}play(){throw'method "play" must be implemented'}pause(){throw'method "pause" must be implemented'}stop(){throw'method "stop" must be implemented'}loop(e){throw'method "loop" must be implemented'}}class wr extends Ze{constructor(o){super(o);D(this,"channel");this.channel=this.source}play(){this.isPlaying=!0,this.channel.play(),this.channel.onended=()=>{this.isPlaying=!1}}pause(){this.isPlaying=!1,this.channel.pause()}stop(){this.pause(),this.channel.currentTime=0}loop(o){this.channel.loop=o}}class Sr extends Ze{constructor(o){super(o);D(this,"channels");this.channels=new Set}checkTrackPaused(){return this.isPlaying}checkChannelsExist(){return this.channels.size>0}resume(){[...this.channels.values()].forEach(o=>{o.play()}),this.isPlaying=!0}playNewChannel(){const o=new Audio;o.src=this.source.src,this.channels.add(o),o.onended=()=>{this.channels.delete(o),this.channels.size===0&&(this.isPlaying=!1)},this.isPlaying=!0,o.play()}play(){!this.checkTrackPaused()&&this.checkChannelsExist()?this.resume():this.playNewChannel()}pause(){this.isPlaying=!1,[...this.channels.values()].forEach(o=>{o.pause()})}stop(){this.isPlaying=!1,[...this.channels.values()].forEach(o=>{o.pause(),this.channels.delete(o)})}}class $o{constructor(){D(this,"audios");this.audios=new Map,this.play=this.play.bind(this),this.pause=this.pause.bind(this),this.stop=this.stop.bind(this)}getTrackExist(e){return this.audios.has(e)}checkTrackExist(e){if(!this.getTrackExist(e))throw`track - ${e} doesn't exist`;return!0}checksBeforePlay(e){return this.checkTrackExist(e)}checkTrackDuplicate(e){if(this.getTrackExist(e))throw`track - ${e} already exist`}createTrack(e){return new Ze(e)}addTrack(e,o){this.audios.set(e,o)}add(e,o,i){this.checkTrackDuplicate(e);const q=this.createTrack(o);this.addTrack(e,q)}play(e){if(!this.checksBeforePlay(e))return;const o=this.audios.get(e);return o.play(),o}loop(e,o){this.audios.get(e).loop(o)}pause(e){const o=this.audios.get(e);return o.pause(),o}stop(e){const o=this.audios.get(e);return o.stop(),o}vol(e,o=1){const i=this.audios.get(e);i.source.volume=o}}class xr extends $o{createTrack(e){return new wr(e)}checkTrackAlreadyPlaying(e){return this.audios.get(e).isPlaying}checksBeforePlay(e){return super.checksBeforePlay(e)&&!this.checkTrackAlreadyPlaying(e)}}class Br extends $o{createTrack(e){return new Sr(e)}}const ft=new Br;ft.add("menuButtonHover",vr);const kr=""+new URL("wall_btn_press-yzD_1Enh.mp3",import.meta.url).href,br=""+new URL("wall_btn_unpress-yukuzspV.mp3",import.meta.url).href,Er=""+new URL("wallOpen-dExMmNpm.mp3",import.meta.url).href,Cr=""+new URL("lvlBg1-QqbxwL-B.mp3",import.meta.url).href,Lr=""+new URL("lvlBg2-ejq0Dw7L.mp3",import.meta.url).href,Mr=""+new URL("lvlBg3-4piO9RY7.mp3",import.meta.url).href,Pr=""+new URL("lvlBg4-xQZhOgRg.mp3",import.meta.url).href,Ir="data:audio/mpeg;base64,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",Yr=""+new URL("pickingSword-aqfZU5qy.mp3",import.meta.url).href,Xr="data:audio/mpeg;base64,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",Tr=""+new URL("torch1-aWQl9N21.mp3",import.meta.url).href,Rr=""+new URL("bugSound1-BDAQReHu.mp3",import.meta.url).href,Or=""+new URL("portalRoomSound-0PH1OQFJ.mp3",import.meta.url).href,Ur=""+new URL("scrollOpen-OmjPVryu.mp3",import.meta.url).href,Zr=""+new URL("closeScroll-8lqyh4f5.mp3",import.meta.url).href,Fr=""+new URL("pickingSpell-gUt3l7O9.mp3",import.meta.url).href,Qr=""+new URL("transformSpell-frF3K3GN.mp3",import.meta.url).href,Nr=""+new URL("healSpell-gIz-LNpI.mp3",import.meta.url).href,Dr=""+new URL("notEnoughMana-nUkprK-P.mp3",import.meta.url).href,Wr=""+new URL("awakening-CF3-B4NO.mp3",import.meta.url).href,Gr=""+new URL("lvlEnd-hG7W4yLL.mp3",import.meta.url).href,Vr="data:audio/mpeg;base64,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",zr=""+new URL("menuBg-Ipsm0nut.mp3",import.meta.url).href,Kr=""+new URL("glassWallSound-ujYIPN1N.mp3",import.meta.url).href,Hr=""+new URL("taskDoneOST-bYpN-sbJ.mp3",import.meta.url).href,jr=""+new URL("scream-sound-qnkCOmB7.mp3",import.meta.url).href,h=new xr;h.add("wall_btn_press",kr);h.add("wall_btn_unpress",br);h.add("wall_opening",Er);h.add("lvlBg1",Cr);h.add("lvlBg2",Lr);h.add("lvlBg3",Mr);h.add("lvlBg4",Pr);h.add("playerSteps1",Ir);h.add("pickingSword",Yr);h.add("swordAttack",Xr);h.add("torch1",Tr);h.add("bugSound1",Rr);h.add("portalRoomSound",Or);h.add("scrollRead",Ur);h.add("scrollClose",Zr);h.add("pickingSpell",Fr);h.add("transformSpell",Qr);h.add("healSpell",Nr);h.add("notEnoughMana",Dr);h.add("awakeningOST",Wr);h.add("lvlEnd",Gr);h.add("menuButtonClick",Vr);h.add("menuBg",zr);h.add("glassWallSound",Kr);h.add("taskDone",Hr);h.add("scream-sound",jr);class j{constructor({fps:e=60,callback:o,tolerance:i=.1}){D(this,"requestID");D(this,"fps");D(this,"callback");D(this,"interval");D(this,"thenTmp",0);D(this,"deltaTmp",0);D(this,"animateLoop",e=>{this.requestID=requestAnimationFrame(this.animateLoop),this.deltaTmp=e-this.thenTmp,this.deltaTmp>=this.interval&&(this.thenTmp=e-this.deltaTmp%this.interval,this.callback(this.deltaTmp))});this.requestID=0,this.fps=e,this.callback=o,this.interval=1e3/this.fps-i}start(){this.thenTmp=performance.now(),this.requestID=requestAnimationFrame(this.animateLoop)}stop(){cancelAnimationFrame(this.requestID)}}let bo,bt=document.getElementById("fpsTourWrap").getElementsByClassName("fpsTourValue")[0],Be,le=null,zt,tn;const Jr=()=>{en(zt),_r()},_r=()=>{zt<30?bt.style.color="red":zt<45?bt.style.color="orange":bt.style.color="lime"},$r=()=>{bt.style.color="white"},en=t=>{bt.textContent=String(t)},ta=()=>{le=performance.now(),zt=Math.floor(1e3/(le-Be)),Be=le},ea=()=>{ta()},on=new j({callback:ea,fps:60}),oa=(t=0)=>{Be=performance.now(),bo=t,on.start(),tn=setInterval(Jr,bo)},na=()=>{clearInterval(tn),on.stop(),en(0),$r()},nn=document.getElementById("fpsTourWrap"),sa=document.getElementById("camera");let ke;const ra=()=>(nn.classList.remove("hide"),oa(1e3),ke=sa.animate([{transform:"rotateX(0deg) rotateY(90deg) translateX(400px) translateZ(-135px)"},{transform:"rotateX(0deg) rotateY(125deg) translateX(-720px) translateZ(-135px)"},{transform:"rotateX(0deg) rotateY(165deg) translateX(-720px) translateZ(-135px)"},{transform:"rotateX(0deg) rotateY(6deg) translateX(-910px) translateZ(793px)"},{transform:"rotateX(11deg) rotateY(10deg) translateX(-800px) translateZ(593px)"},{transform:"rotateX(14deg) rotateY(-45deg) translateX(-965px) translateZ(680px)"},{transform:"rotateX(-3deg) rotateY(-180deg) translateX(-965px) translateZ(300px)"},{transform:"rotateX(-3deg) rotateY(-180deg) translateX(-965px) translateZ(100px)"}],{duration:35e3}),ke),aa=()=>{nn.classList.add("hide"),ke.cancel(),na()},ia=document.getElementById("UISection"),ca=()=>{ia.classList.remove("hide")};let sn=0,rn=0,an=0,cn=0,ln=0,An=0,qn=0;const qt=()=>sn,dt=()=>rn,la=()=>an,yt=t=>{sn=t},gt=t=>{rn=t},Fe=t=>{an=t},Qe=()=>cn,dn=()=>ln,$t=()=>An,un=()=>qn,Aa=t=>{cn=t},qa=t=>{ln=t},da=t=>{An=t},ua=t=>{qn=t};let pn=0,hn=0;const pa=({x:t,y:e,z:o})=>{pn=t,hn=o},Ne=()=>qt()-pn,De=()=>dt()-hn;class st{constructor(){D(this,"subscribers");this.subscribers=[]}subscribe(e){this.subscribers.push(e)}unsubscribe(e){this.subscribers=this.subscribers.filter(o=>o!==e)}broadcast(e){this.subscribers.forEach(o=>o(e))}}const ha=30;let mn=30,fn=30,yn=0,gn=1,vn=0,wn=1,Sn=0,xn=0;const Bn=()=>ha,rt=()=>mn,at=()=>fn,ma=()=>yn,fa=()=>gn,ya=()=>vn,ga=()=>wn,kn=()=>Sn,bn=()=>xn,te=t=>{mn=t},ee=t=>{fn=t},va=t=>{yn=t},wa=t=>{gn=t},Sa=t=>{vn=t},xa=t=>{wn=t},Ba=t=>{Sn=t},ka=t=>{xn=t},J=new st;let We,G=!1,Ge,V=!1;const ba=()=>{gt(Math.floor(dt()+at()*ga())),yt(Math.floor(qt()+rt()*ya()))},Ea=()=>{gt(Math.floor(dt()+at()*fa())),yt(Math.floor(qt()+rt()*ma()))},Ca=()=>{G=!0,V===!1&&J.broadcast(!0),We=Eo,Eo.start()},La=()=>{G=!0,V===!1&&J.broadcast(!0),We=Co,Co.start()},be=()=>{G=!1,We.stop(),V===!1&&J.broadcast(!1)},Eo=new j({callback:Ea,fps:30}),Co=new j({callback:ba,fps:30}),Ma=()=>{yt(Math.floor(qt()-rt()*kn())),gt(Math.floor(dt()-at()*bn()))},Pa=()=>{yt(Math.floor(qt()+rt()*kn())),gt(Math.floor(dt()+at()*bn()))},Ia=()=>{V=!0,G===!1&&J.broadcast(!0),Ge=Mo,Mo.start()},Ya=()=>{V=!0,G===!1&&J.broadcast(!0),Ge=Lo,Lo.start()},Ee=()=>{V=!1,Ge.stop(),G===!1&&J.broadcast(!1)},Lo=new j({callback:Pa,fps:30}),Mo=new j({callback:Ma,fps:30}),Kt=Bn()/-3.75;let ct=!1;const Nt=()=>{ct=!0,te(rt()+Kt),ee(at()+Kt)},kt=()=>{ct=!1,te(rt()-Kt),ee(at()-Kt)},En=t=>{if(t.code==="KeyW"){if(G)return;V&&Nt(),Ca();return}else if(t.code==="KeyS"){if(G)return;V&&Nt(),La();return}else if(t.code==="KeyA"){if(V)return;G&&Nt(),Ia();return}else if(t.code==="KeyD"){if(V)return;G&&Nt(),Ya();return}},Cn=t=>{if(t.code==="KeyW"){if(!G)return;ct&&kt(),be()}else if(t.code==="KeyS"){if(!G)return;ct&&kt(),be()}else if(t.code==="KeyA"){if(!V)return;ct&&kt(),Ee()}else if(t.code==="KeyD"){if(!V)return;ct&&kt(),Ee()}},Xa=()=>{window.addEventListener("keydown",En),window.addEventListener("keyup",Cn)},Ta=()=>{window.removeEventListener("keydown",En),window.removeEventListener("keyup",Cn)},Ra=()=>{G&&be(),V&&Ee(),ct&&kt()},Yt=new Map,Q=(t,e)=>{Yt.set(t,e)},nt=t=>{Yt.delete(t)},Ln=t=>{const e=Yt.get(t);if(!e)throw`unknown item - ${t}`;e.isActive=!1},Oa=()=>{Yt.forEach(t=>{t.deactivationCallback(),t.isActive=!1})};let Ce,Le;const oe=()=>{Ce=Ne(),Le=De();let t;Yt.forEach(e=>{if(t=Ua(e),t){if(e.isActive)return;e.isActive=!0,e.activationCallback();return}else if(e.isActive){e.isActive=!1,e.deactivationCallback();return}})},Ua=t=>Ce>=t.minX&&Ce<=t.maxX&&Le>=t.minZ&&Le<=t.maxZ,Za=()=>{In.start()},Mn=()=>{In.stop()},Pn=t=>{t?Za():Mn()},In=new j({callback:oe,fps:10}),Yn=()=>{J.subscribe(Pn)},Fa=()=>{J.unsubscribe(Pn)},Xn=document.getElementById("hpBar");let Et=0;const Tn=()=>{Xn.animate([{opacity:.5},{opacity:1},{opacity:.5}],{duration:500})},Qa=t=>{Et=t,Tn(),Rn()},Na=t=>{Et+=t,Et>100&&(Et=100),Tn(),Rn()},Rn=()=>{Xn.style.setProperty("--hpValue",`${Et}%`)},ne=document.getElementById("subPanelsSection"),Ve={controlsSection:document.getElementById("controlsSection"),aboutSection:document.getElementById("aboutSection"),touchScreenMSG:document.getElementById("touchScreenMSG")};let Ht=null;const Da=()=>{ne.classList.remove("hide")},Wa=()=>{ne.classList.add("hide")},Ga=t=>{const e=Ve[t];if(!e)throw`unknown sub panel - ${t}`;e.classList.remove("hide"),Ht=t},Va=t=>{const e=Ve[t];if(!e)throw`unknown sub panel - ${t}`;e.classList.add("hide"),Ht=t},Lt=t=>{Ga(t),Da()},On=t=>{Va(t),Wa()},za=({target:t})=>{t.classList.contains("subPanelsSection_closeButton")&&(On(Ht),Ht=null,h.play("menuButtonClick"))};ne.addEventListener("click",za);const Ka=({target:t})=>{t.classList.contains("subPanelsSection_closeButton")&&ft.play("menuButtonHover")};ne.addEventListener("mouseover",Ka);const ze=document.getElementById("pointerLockInaccessibleIcon");let Me=!1;const Ha=async()=>{Me||(Ja(),await ja(),_a())},ja=()=>{Me=!0;const t=ze.animate([{transform:"scale(1)"},{transform:"scale(0.7)"},{transform:"scale(1)"}],{duration:1e3});return t.finished.then(()=>{Me=!1}),t.finished},Ja=()=>{ze.classList.remove("hide")},_a=()=>{ze.classList.add("hide")},$a=(t,e)=>Math.random()*(e-t)+t|0;var _o;const ti=(_o=new Array(["Microsoft Edge",/edg/i],["Microsoft Internet Explorer",/trident/i],["Mozilla Firefox",/firefox|fxios/i],["Opera",/opr\//i],["UC Browser",/ucbrowser/i],["Samsung Browser",/samsungbrowser/i],["Google Chrome",/chrome|chromium|crios/i],["Apple Safari",/safari/i],["Unknown",/.+/i]).find(([,t])=>t.test(window.navigator.userAgent)))==null?void 0:_o.shift(),ei=()=>ti,lt=new st,Un=document.body.requestPointerLock.bind(document.body),Zn=()=>{document.pointerLockElement===document.body?lt.broadcast(!0):lt.broadcast(!1)},oi=()=>{Un().catch(Ha)},ni=()=>{Un()};let si=ei()==="Google Chrome"?oi:ni;const Xt=()=>{si()},Ke=()=>{document.exitPointerLock()},ri=()=>{document.addEventListener("pointerlockchange",Zn),document.addEventListener("click",Xt)},ai=()=>{document.removeEventListener("pointerlockchange",Zn),document.removeEventListener("click",Xt)},Po=document.getElementById("infoIcon"),ii=t=>{t.stopPropagation(),h.play("menuButtonClick"),Lt("controlsSection")},ci=()=>{ft.play("menuButtonHover")},li=t=>{if(t.code==="KeyI"){if(Ve.controlsSection.classList.contains("hide")){Ai();return}qi()}},Ai=()=>{Ke(),h.play("menuButtonClick"),Lt("controlsSection")},qi=()=>{Xt(),h.play("menuButtonClick"),On("controlsSection")},di=()=>{Po.addEventListener("mouseover",ci),Po.addEventListener("click",ii),window.addEventListener("keydown",li)},Fn=document.getElementById("manaBar"),ui=3,pi=500;let _=0,Qn=null;const hi=t=>{_=t,He()},Nn=()=>{Fn.animate([{opacity:.5},{opacity:1},{opacity:.5}],{duration:500})},Dn=()=>_,Wn=t=>{t<=_?_-=t:_=0,He()},mi=t=>{_+=t,_>100&&(_=100),He()},He=()=>{Fn.style.setProperty("--manaValue",`${_}%`)},fi=()=>{Qn=setInterval(mi,pi,ui)},yi=()=>{clearInterval(Qn)};let Gn,Vn;const gi=()=>Gn,vi=()=>Vn,wi=t=>{Vn=t},Si=t=>{Gn=t},zn=new st,Kn=()=>{const t=visualViewport.height!==gi(),e=visualViewport.width!==vi();Si(visualViewport.height),wi(visualViewport.width),zn.broadcast({height:visualViewport.height,width:visualViewport.width,heightChanged:t,widthChanged:e})};visualViewport.addEventListener("resize",Kn);const Hn=document.getElementById("playerHands"),jn=document.getElementById("playerHandsWrap"),xi=document.getElementById("playerHandsInner"),Bi=t=>Math.floor(t/1.3)/4,ki=({height:t})=>{Hn.style.height=t+"px",xi.style.transform=`
    translateX(${Bi(t)}px) 
    translateY(12%)`},Jn=()=>{jn.classList.add("show")},bi=()=>{jn.classList.remove("show")};zn.subscribe(ki);let Ae=!1;const _n=async()=>{Ae||(Ae=!0,h.play("swordAttack"),await Ei(),Ae=!1)},Io=`
  rotateX(0deg) 
  rotateY(0deg) 
  rotateZ(0deg) 
  translateY(0px)
  translateX(0px)  
  skew(0deg, 0deg)
  scale(1)`,Yo=`
  rotateX(0deg) 
  rotateY(0deg) 
  rotateZ(15deg) 
  translateY(-150px)
  translateX(0px)  
  skew(0deg, -0deg)
  scale(1)`,Xo=`
  rotateX(70deg)         
  rotateY(-50deg)         
  rotateZ(-20deg)         
  translateY(-3px)        
  translateX(0px)          
  skew(0deg, -30deg)        
  scale(1)`,qe=(t,e,o)=>Hn.animate([{transform:t},{transform:e}],{duration:o}).finished,Ei=async()=>{await qe(Io,Yo,120),await qe(Yo,Xo,150),await qe(Xo,Io,230)},$n=()=>{window.addEventListener("click",_n)},ts=()=>{window.removeEventListener("click",_n)},je=document.getElementById("activeItemTips"),$=t=>{Ci(t),Li()},Ci=t=>{je.textContent=t},Li=()=>{je.classList.remove("hide")},Z=()=>{je.classList.add("hide")},Je=document.querySelector("#room5 .swordItem1");let es=!1;const _e=()=>es,$e=t=>{t.code==="KeyE"&&(window.removeEventListener("keydown",$e),Je.remove(),Jn(),h.play("pickingSword"),$n(),es=!0,nt("room5Sword"),Z())},Mi=()=>{Je.style.filter="brightness(1.5)",window.addEventListener("keydown",$e),$("press E")},Pi=()=>{Je.style.filter="brightness(1)",window.removeEventListener("keydown",$e),Z()};Q("room5Sword",{isActive:!1,maxX:450,minX:-50,maxZ:3350,minZ:3050,activationCallback:Mi,deactivationCallback:Pi});let os=!1;const Ii=t=>{os=t},Yi=()=>{lt.subscribe(Ii)},ns=()=>os,ss=document.getElementById("openedScrollWrap"),Xi=document.getElementById("openedScroll"),Ti=document.getElementById("scrollContentWrap");let to=!1;const Ri=t=>{t.code==="KeyQ"&&Oi()},rs=()=>Xi,as=t=>{Ti.innerHTML=t},is=()=>{to=!0,Tt(!1),h.play("scrollRead"),ss.classList.add("open"),window.addEventListener("keydown",Ri)},Oi=()=>{to=!1,h.play("scrollClose"),ss.classList.remove("open"),Tt(ns())},Ui=()=>to,At=t=>t>360?t-360:t<0?t+360:t;let z={x:0,z:0};const eo=t=>(t<=90?Zi(t):t<=180?Fi(t):t<=270?Qi(t):t<=360&&Ni(t),z),Zi=t=>{z.x=t/90*-1,z.z=1+z.x},Fi=t=>{z.z=(t/90-1)*-1,z.x=(1+z.z)*-1},Qi=t=>{z.x=t/90-2,z.z=(1-z.x)*-1},Ni=t=>{z.z=t/90-3,z.x=1-z.z},oo=new st;let it={newRealAngleX:0,newRealAngleY:0,newNormalizedAngleX:0,newNormalizedAngleY:0,movementX:0,movementY:0};const no=t=>{it.newRealAngleX=Qe()-t.movementX,it.newRealAngleY=dn()-t.movementY,it.newNormalizedAngleX=At($t()-t.movementX),it.newNormalizedAngleY=At(un()-t.movementY),oo.broadcast(it)},Di=()=>{it={newRealAngleX:0,newRealAngleY:0,newNormalizedAngleX:0,newNormalizedAngleY:0,movementX:1,movementY:0},oo.broadcast(it)},Wi=()=>{document.addEventListener("mousemove",no)},Gi=()=>{document.removeEventListener("mousemove",no)},Mt=document.getElementById("movementBar");let Gt;const cs=t=>{t&&Mt.classList.remove(t),Gt=t,Mt.classList.add(t)},ls=()=>{Mt.classList.remove("hide")},As=()=>{Mt.classList.add("hide"),Gt&&(Mt.classList.remove(Gt),Gt=null)},so=new st,jt=Bn()/1.5;let ro=!0,mt=!1;const qs=()=>mt,Vi=()=>{ro&&(mt=!0,ee(at()+jt),te(rt()+jt),so.broadcast(mt),cs("run"),ls())},ds=()=>{mt=!1,ee(at()-jt),te(rt()-jt),so.broadcast(mt),As()},us=()=>{ro=!1,mt&&ds()},ps=()=>{ro=!0},hs=t=>{qs()||t.code==="ShiftLeft"&&Vi()},ms=t=>{qs()&&t.code==="ShiftLeft"&&ds()},zi=()=>{window.addEventListener("keydown",hs),window.addEventListener("keyup",ms)},Ki=()=>{window.removeEventListener("keydown",hs),window.removeEventListener("keyup",ms)};let Hi=0,fs=0,ji=0;const Ji=()=>Hi,ao=()=>fs,_i=()=>ji,ys=t=>{fs=t},gs=150;let Jt=!1;const vs=()=>Jt,$i=()=>{Jt=!0,ys(ao()-gs),us(),cs("squat"),ls()},ws=()=>{Jt&&(Jt=!1,ys(ao()+gs),ps(),As())},Ss=t=>{vs()||t.code==="KeyC"&&$i()},xs=t=>{vs()&&t.code==="KeyC"&&ws()},Bs=()=>{window.addEventListener("keydown",Ss),window.addEventListener("keyup",xs)},ks=()=>{window.removeEventListener("keydown",Ss),window.removeEventListener("keyup",xs)},Tt=t=>{if(t){Xa(),ps(),zi(),Bs(),Wi(),_e()&&$n();return}Ta(),Ra(),Ki(),us(),ks(),ws(),Gi(),ts()},tc=t=>{Ui()||Tt(t)},ec=()=>{lt.subscribe(tc)};var ot=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},io={},tt={},bs={exports:{}};(function(t,e){/** @preserve SAT.js - Version 0.9.0 - Copyright 2012 - 2021 - Jim Riecken <jimr@jimr.ca> - released under the MIT License. https://github.com/jriecken/sat-js */(function(o,i){t.exports=i()})(ot,function(){var o={};function i(n,c){this.x=n||0,this.y=c||0}o.Vector=i,o.V=i,i.prototype.copy=i.prototype.copy=function(n){return this.x=n.x,this.y=n.y,this},i.prototype.clone=i.prototype.clone=function(){return new i(this.x,this.y)},i.prototype.perp=i.prototype.perp=function(){var n=this.x;return this.x=this.y,this.y=-n,this},i.prototype.rotate=i.prototype.rotate=function(n){var c=this.x,r=this.y;return this.x=c*Math.cos(n)-r*Math.sin(n),this.y=c*Math.sin(n)+r*Math.cos(n),this},i.prototype.reverse=i.prototype.reverse=function(){return this.x=-this.x,this.y=-this.y,this},i.prototype.normalize=i.prototype.normalize=function(){var n=this.len();return n>0&&(this.x=this.x/n,this.y=this.y/n),this},i.prototype.add=i.prototype.add=function(n){return this.x+=n.x,this.y+=n.y,this},i.prototype.sub=i.prototype.sub=function(n){return this.x-=n.x,this.y-=n.y,this},i.prototype.scale=i.prototype.scale=function(n,c){return this.x*=n,this.y*=typeof c<"u"?c:n,this},i.prototype.project=i.prototype.project=function(n){var c=this.dot(n)/n.len2();return this.x=c*n.x,this.y=c*n.y,this},i.prototype.projectN=i.prototype.projectN=function(n){var c=this.dot(n);return this.x=c*n.x,this.y=c*n.y,this},i.prototype.reflect=i.prototype.reflect=function(n){var c=this.x,r=this.y;return this.project(n).scale(2),this.x-=c,this.y-=r,this},i.prototype.reflectN=i.prototype.reflectN=function(n){var c=this.x,r=this.y;return this.projectN(n).scale(2),this.x-=c,this.y-=r,this},i.prototype.dot=i.prototype.dot=function(n){return this.x*n.x+this.y*n.y},i.prototype.len2=i.prototype.len2=function(){return this.dot(this)},i.prototype.len=i.prototype.len=function(){return Math.sqrt(this.len2())};function q(n,c){this.pos=n||new i,this.r=c||0,this.offset=new i}o.Circle=q,q.prototype.getAABBAsBox=q.prototype.getAABBAsBox=function(){var n=this.r,c=this.pos.clone().add(this.offset).sub(new i(n,n));return new x(c,n*2,n*2)},q.prototype.getAABB=q.prototype.getAABB=function(){return this.getAABBAsBox().toPolygon()},q.prototype.setOffset=q.prototype.setOffset=function(n){return this.offset=n,this};function l(n,c){this.pos=n||new i,this.angle=0,this.offset=new i,this.setPoints(c||[])}o.Polygon=l,l.prototype.setPoints=l.prototype.setPoints=function(n){var c=!this.points||this.points.length!==n.length;if(c){var r,p=this.calcPoints=[],u=this.edges=[],S=this.normals=[];for(r=0;r<n.length;r++){var B=n[r],d=r<n.length-1?n[r+1]:n[0];if(B!==d&&B.x===d.x&&B.y===d.y){n.splice(r,1),r-=1;continue}p.push(new i),u.push(new i),S.push(new i)}}return this.points=n,this._recalc(),this},l.prototype.setAngle=l.prototype.setAngle=function(n){return this.angle=n,this._recalc(),this},l.prototype.setOffset=l.prototype.setOffset=function(n){return this.offset=n,this._recalc(),this},l.prototype.rotate=l.prototype.rotate=function(n){for(var c=this.points,r=c.length,p=0;p<r;p++)c[p].rotate(n);return this._recalc(),this},l.prototype.translate=l.prototype.translate=function(n,c){for(var r=this.points,p=r.length,u=0;u<p;u++)r[u].x+=n,r[u].y+=c;return this._recalc(),this},l.prototype._recalc=function(){var n=this.calcPoints,c=this.edges,r=this.normals,p=this.points,u=this.offset,S=this.angle,B=p.length,d;for(d=0;d<B;d++){var L=n[d].copy(p[d]);L.x+=u.x,L.y+=u.y,S!==0&&L.rotate(S)}for(d=0;d<B;d++){var P=n[d],O=d<B-1?n[d+1]:n[0],F=c[d].copy(O).sub(P);r[d].copy(F).perp().normalize()}return this},l.prototype.getAABBAsBox=l.prototype.getAABBAsBox=function(){for(var n=this.calcPoints,c=n.length,r=n[0].x,p=n[0].y,u=n[0].x,S=n[0].y,B=1;B<c;B++){var d=n[B];d.x<r?r=d.x:d.x>u&&(u=d.x),d.y<p?p=d.y:d.y>S&&(S=d.y)}return new x(this.pos.clone().add(new i(r,p)),u-r,S-p)},l.prototype.getAABB=l.prototype.getAABB=function(){return this.getAABBAsBox().toPolygon()},l.prototype.getCentroid=l.prototype.getCentroid=function(){for(var n=this.calcPoints,c=n.length,r=0,p=0,u=0,S=0;S<c;S++){var B=n[S],d=S===c-1?n[0]:n[S+1],L=B.x*d.y-d.x*B.y;r+=(B.x+d.x)*L,p+=(B.y+d.y)*L,u+=L}return u=u*3,r=r/u,p=p/u,new i(r,p)};function x(n,c,r){this.pos=n||new i,this.w=c||0,this.h=r||0}o.Box=x,x.prototype.toPolygon=x.prototype.toPolygon=function(){var n=this.pos,c=this.w,r=this.h;return new l(new i(n.x,n.y),[new i,new i(c,0),new i(c,r),new i(0,r)])};function E(){this.a=null,this.b=null,this.overlapN=new i,this.overlapV=new i,this.clear()}o.Response=E,E.prototype.clear=E.prototype.clear=function(){return this.aInB=!0,this.bInA=!0,this.overlap=Number.MAX_VALUE,this};for(var k=[],X=0;X<10;X++)k.push(new i);for(var Y=[],X=0;X<5;X++)Y.push([]);var W=new E,g=new x(new i,1e-6,1e-6).toPolygon();function w(n,c,r){for(var p=Number.MAX_VALUE,u=-Number.MAX_VALUE,S=n.length,B=0;B<S;B++){var d=n[B].dot(c);d<p&&(p=d),d>u&&(u=d)}r[0]=p,r[1]=u}function b(n,c,r,p,u,S){var B=Y.pop(),d=Y.pop(),L=k.pop().copy(c).sub(n),P=L.dot(u);if(w(r,u,B),w(p,u,d),d[0]+=P,d[1]+=P,B[0]>d[1]||d[0]>B[1])return k.push(L),Y.push(B),Y.push(d),!0;if(S){var O=0;if(B[0]<d[0])if(S.aInB=!1,B[1]<d[1])O=B[1]-d[0],S.bInA=!1;else{var F=B[1]-d[0],N=d[1]-B[0];O=F<N?F:-N}else if(S.bInA=!1,B[1]>d[1])O=B[0]-d[1],S.aInB=!1;else{var F=B[1]-d[0],N=d[1]-B[0];O=F<N?F:-N}var R=Math.abs(O);R<S.overlap&&(S.overlap=R,S.overlapN.copy(u),O<0&&S.overlapN.reverse())}return k.push(L),Y.push(B),Y.push(d),!1}o.isSeparatingAxis=b;function M(n,c){var r=n.len2(),p=c.dot(n);return p<0?C:p>r?s:T}var C=-1,T=0,s=1;function a(n,c){var r=k.pop().copy(n).sub(c.pos).sub(c.offset),p=c.r*c.r,u=r.len2();return k.push(r),u<=p}o.pointInCircle=a;function A(n,c){g.pos.copy(n),W.clear();var r=v(g,c,W);return r&&(r=W.aInB),r}o.pointInPolygon=A;function m(n,c,r){var p=k.pop().copy(c.pos).add(c.offset).sub(n.pos).sub(n.offset),u=n.r+c.r,S=u*u,B=p.len2();if(B>S)return k.push(p),!1;if(r){var d=Math.sqrt(B);r.a=n,r.b=c,r.overlap=u-d,r.overlapN.copy(p.normalize()),r.overlapV.copy(p).scale(r.overlap),r.aInB=n.r<=c.r&&d<=c.r-n.r,r.bInA=c.r<=n.r&&d<=n.r-c.r}return k.push(p),!0}o.testCircleCircle=m;function f(n,c,r){for(var p=k.pop().copy(c.pos).add(c.offset).sub(n.pos),u=c.r,S=u*u,B=n.calcPoints,d=B.length,L=k.pop(),P=k.pop(),O=0;O<d;O++){var F=O===d-1?0:O+1,N=O===0?d-1:O-1,R=0,wt=null;L.copy(n.edges[O]),P.copy(p).sub(B[O]),r&&P.len2()>S&&(r.aInB=!1);var pt=M(L,P);if(pt===C){L.copy(n.edges[N]);var ie=k.pop().copy(p).sub(B[N]);if(pt=M(L,ie),pt===s){var K=P.len();if(K>u)return k.push(p),k.push(L),k.push(P),k.push(ie),!1;r&&(r.bInA=!1,wt=P.normalize(),R=u-K)}k.push(ie)}else if(pt===s){if(L.copy(n.edges[F]),P.copy(p).sub(B[F]),pt=M(L,P),pt===C){var K=P.len();if(K>u)return k.push(p),k.push(L),k.push(P),!1;r&&(r.bInA=!1,wt=P.normalize(),R=u-K)}}else{var ce=L.perp().normalize(),K=P.dot(ce),ur=Math.abs(K);if(K>0&&ur>u)return k.push(p),k.push(ce),k.push(P),!1;r&&(wt=ce,R=u-K,(K>=0||R<2*u)&&(r.bInA=!1))}wt&&r&&Math.abs(R)<Math.abs(r.overlap)&&(r.overlap=R,r.overlapN.copy(wt))}return r&&(r.a=n,r.b=c,r.overlapV.copy(r.overlapN).scale(r.overlap)),k.push(p),k.push(L),k.push(P),!0}o.testPolygonCircle=f;function y(n,c,r){var p=f(c,n,r);if(p&&r){var u=r.a,S=r.aInB;r.overlapN.reverse(),r.overlapV.reverse(),r.a=r.b,r.b=u,r.aInB=r.bInA,r.bInA=S}return p}o.testCirclePolygon=y;function v(n,c,r){for(var p=n.calcPoints,u=p.length,S=c.calcPoints,B=S.length,d=0;d<u;d++)if(b(n.pos,c.pos,p,S,n.normals[d],r))return!1;for(var d=0;d<B;d++)if(b(n.pos,c.pos,p,S,c.normals[d],r))return!1;return r&&(r.a=n,r.b=c,r.overlapV.copy(r.overlapN).scale(r.overlap)),!0}return o.testPolygonPolygon=v,o})})(bs);var Rt=bs.exports;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Types=t.Response=void 0;var e=Rt;Object.defineProperty(t,"Response",{enumerable:!0,get:function(){return e.Response}}),function(o){o.Ellipse="Ellipse",o.Line="Line",o.Circle="Circle",o.Box="Box",o.Point="Point",o.Polygon="Polygon"}(t.Types||(t.Types={}))})(tt);var Ot={},I={},St={},xt={},To;function Ut(){if(To)return xt;To=1,Object.defineProperty(xt,"__esModule",{value:!0}),xt.Polygon=void 0;const t=Rt,e=tt,o=ut();class i extends t.Polygon{constructor(l,x){if(super((0,o.ensureVectorPoint)(l),(0,o.ensurePolygonPoints)(x)),this.type=e.Types.Polygon,!(x!=null&&x.length))throw new Error("No points in polygon");this.updateAABB()}get x(){return this.pos.x}set x(l){var x;this.pos.x=l,(x=this.system)===null||x===void 0||x.updateBody(this)}get y(){return this.pos.y}set y(l){var x;this.pos.y=l,(x=this.system)===null||x===void 0||x.updateBody(this)}setPosition(l,x){var E;this.pos.x=l,this.pos.y=x,(E=this.system)===null||E===void 0||E.updateBody(this)}updateAABB(){const{pos:l,w:x,h:E}=this.getAABBAsBox();this.minX=l.x,this.minY=l.y,this.maxX=l.x+x,this.maxY=l.y+E}draw(l){[...this.calcPoints,this.calcPoints[0]].forEach((E,k)=>{const X=this.pos.x+E.x,Y=this.pos.y+E.y,W=this.calcPoints[k-1]||this.calcPoints[this.calcPoints.length-1];if(!k)this.calcPoints.length===1?l.arc(X,Y,1,0,Math.PI*2):l.moveTo(X,Y);else if(this.calcPoints.length>1)if(this.isTrigger){const g=this.pos.x+W.x,w=this.pos.y+W.y;(0,o.dashLineTo)(l,g,w,X,Y)}else l.lineTo(X,Y)})}}return xt.Polygon=i,xt}var Ro;function co(){if(Ro)return St;Ro=1,Object.defineProperty(St,"__esModule",{value:!0}),St.Line=void 0;const t=tt,e=Ut();class o extends e.Polygon{constructor(q,l){if(super({x:(q.x+l.x)/2,y:(q.y+l.y)/2},[{x:-(l.x-q.x)/2,y:-(l.y-q.y)/2},{x:(l.x-q.x)/2,y:(l.y-q.y)/2}]),this.type=t.Types.Line,this.calcPoints.length===1||!l)throw console.error({start:q,end:l}),new Error("No end point for line provided")}get start(){return{x:this.x+this.calcPoints[0].x,y:this.y+this.calcPoints[0].y}}get end(){return{x:this.x+this.calcPoints[1].x,y:this.y+this.calcPoints[1].y}}}return St.Line=o,St}var Oo;function ut(){if(Oo)return I;Oo=1,Object.defineProperty(I,"__esModule",{value:!0}),I.intersectLinePolygon=I.intersectLineLine=I.intersectLineCircle=I.dashLineTo=I.clockwise=I.distance=I.ensurePolygonPoints=I.ensureVectorPoint=I.createBox=I.createEllipse=void 0;const t=Rt,e=co();function o(g,w=g,b=1){const M=Math.PI*Math.hypot(g,w)*2,C=Math.max(8,Math.ceil(M/b));return Array.from({length:C},(T,s)=>{const a=s/C*2*Math.PI,A=Math.cos(a)*g,m=Math.sin(a)*w;return new t.Vector(A,m)})}I.createEllipse=o;function i(g,w){return[new t.Vector(0,0),new t.Vector(g,0),new t.Vector(g,w),new t.Vector(0,w)]}I.createBox=i;function q(g={}){return g instanceof t.Vector?g:new t.Vector(g.x||0,g.y||0)}I.ensureVectorPoint=q;function l(g){if(!g)throw new Error("No points array provided");const w=g.map(q);return E(w)?w.reverse():w}I.ensurePolygonPoints=l;function x(g,w){return Math.hypot(g.x-w.x,g.y-w.y)}I.distance=x;function E(g){let w=0;for(let b=0;b<g.length;b++){const M=g[b],C=g[(b+1)%g.length];w+=(C.x-M.x)*(C.y+M.y)}return w>0}I.clockwise=E;function k(g,w,b,M,C,T=2,s=4){const a=M-w,A=C-b,m=Math.atan2(A,a),f=Math.cos(m),y=Math.sin(m);let v=w,n=b,c=Math.hypot(a,A);for(;c>0;){const r=Math.min(c,T);g.moveTo(v,n),g.lineTo(v+f*r,n+y*r),v+=f*(T+s),n+=y*(T+s),c-=T+s}}I.dashLineTo=k;function X(g,w){const b={x:g.end.x-g.start.x,y:g.end.y-g.start.y},M={x:g.start.x-w.pos.x,y:g.start.y-w.pos.y},C=(b.x*M.x+b.y*M.y)*-2,T=(b.x*b.x+b.y*b.y)*2,s=Math.sqrt(C*C-(M.x*M.x+M.y*M.y-w.r*w.r)*T*2);if(isNaN(s))return[];const a=(C-s)/T,A=(C+s)/T,m=[];return a<=1&&a>=0&&m.push({x:g.start.x+b.x*a,y:g.start.y+b.y*a}),A<=1&&A>=0&&m.push({x:g.start.x+b.x*A,y:g.start.y+b.y*A}),m}I.intersectLineCircle=X;function Y(g,w){const b=g.end.x-g.start.x,M=g.end.y-g.start.y,C=b*(w.end.y-w.start.y)-(w.end.x-w.start.x)*M;if(C===0)return null;const T=((w.end.y-w.start.y)*(w.end.x-g.start.x)+(w.start.x-w.end.x)*(w.end.y-g.start.y))/C,s=((g.start.y-g.end.y)*(w.end.x-g.start.x)+b*(w.end.y-g.start.y))/C;return!(T>=0&&T<=1)||!(s>=0&&s<=1)?null:{x:g.start.x+T*b,y:g.start.y+T*M}}I.intersectLineLine=Y;function W(g,w){return w.calcPoints.map((b,M)=>{const C=M?w.calcPoints[M-1]:w.calcPoints[w.calcPoints.length-1],T=new e.Line({x:C.x+w.pos.x,y:C.y+w.pos.y},{x:b.x+w.pos.x,y:b.y+w.pos.y});return Y(g,T)}).filter(b=>!!b)}return I.intersectLinePolygon=W,I}Object.defineProperty(Ot,"__esModule",{value:!0});Ot.Circle=void 0;const oc=Rt,nc=tt,Uo=ut();class sc extends oc.Circle{constructor(e,o){super((0,Uo.ensureVectorPoint)(e),o),this.type=nc.Types.Circle,this.updateAABB()}get x(){return this.pos.x}set x(e){var o;this.pos.x=e,(o=this.system)===null||o===void 0||o.updateBody(this)}get y(){return this.pos.y}set y(e){var o;this.pos.y=e,(o=this.system)===null||o===void 0||o.updateBody(this)}setPosition(e,o){var i;this.pos.x=e,this.pos.y=o,(i=this.system)===null||i===void 0||i.updateBody(this)}updateAABB(){this.minX=this.pos.x-this.r,this.minY=this.pos.y-this.r,this.maxX=this.pos.x+this.r,this.maxY=this.pos.y+this.r}draw(e){const o=this.r;if(this.isTrigger){const i=Math.max(8,o);for(let q=0;q<i;q++){const l=q/i*2*Math.PI,x=(q-1)/i*2*Math.PI,E=this.pos.x+Math.cos(x)*o,k=this.pos.y+Math.sin(x)*o,X=this.pos.x+Math.cos(l)*o,Y=this.pos.y+Math.sin(l)*o;(0,Uo.dashLineTo)(e,E,k,X,Y)}}else e.moveTo(this.pos.x+o,this.pos.y),e.arc(this.pos.x,this.pos.y,o,0,Math.PI*2)}}Ot.Circle=sc;var Zt={};Object.defineProperty(Zt,"__esModule",{value:!0});Zt.Ellipse=void 0;const rc=tt,Dt=ut(),ac=Ut();class ic extends ac.Polygon{constructor(e,o,i=o,q=Math.hypot(o,i)/Math.PI){super(e,(0,Dt.createEllipse)(o,i,q)),this.type=rc.Types.Ellipse,this._radiusX=o,this._radiusY=i,this._step=q}get step(){return this._step}set step(e){this._step=e,this.setPoints((0,Dt.createEllipse)(this._radiusX,this._radiusY,this._step))}get radiusX(){return this._radiusX}set radiusX(e){this._radiusX=e,this.setPoints((0,Dt.createEllipse)(this._radiusX,this._radiusY,this._step))}get radiusY(){return this._radiusY}set radiusY(e){this._radiusY=e,this.setPoints((0,Dt.createEllipse)(this._radiusX,this._radiusY,this._step))}}Zt.Ellipse=ic;var vt={};Object.defineProperty(vt,"__esModule",{value:!0});vt.Box=void 0;const cc=tt,de=ut(),lc=Ut();class Ac extends lc.Polygon{constructor(e,o,i){super(e,(0,de.createBox)(o,i)),this.type=cc.Types.Box,this._width=o,this._height=i}get width(){return this._width}set width(e){this._width=e,this.setPoints((0,de.createBox)(this._width,this._height))}get height(){return this._height}set height(e){this._height=e,this.setPoints((0,de.createBox)(this._width,this._height))}getCentroidWithoutRotation(){const e=this.angle;this.setAngle(0);const o=this.getCentroid();return this.setAngle(e),o}center(){const e=this.points[0];if(e.x!==0||e.y!==0)return;const{x:o,y:i}=this.getCentroidWithoutRotation();this.translate(-o,-i),this.setPosition(this.pos.x+o,this.pos.y+i)}}vt.Box=Ac;var Ft={};Object.defineProperty(Ft,"__esModule",{value:!0});Ft.Point=void 0;const qc=vt,dc=tt,uc=ut();class pc extends qc.Box{constructor(e){super((0,uc.ensureVectorPoint)(e),.1,.1),this.type=dc.Types.Point}}Ft.Point=pc;var se={},Es={exports:{}};(function(t,e){(function(o,i){t.exports=i()})(ot,function(){function o(s,a,A,m,f){(function y(v,n,c,r,p){for(;r>c;){if(r-c>600){var u=r-c+1,S=n-c+1,B=Math.log(u),d=.5*Math.exp(2*B/3),L=.5*Math.sqrt(B*d*(u-d)/u)*(S-u/2<0?-1:1),P=Math.max(c,Math.floor(n-S*d/u+L)),O=Math.min(r,Math.floor(n+(u-S)*d/u+L));y(v,n,P,O,p)}var F=v[n],N=c,R=r;for(i(v,c,n),p(v[r],F)>0&&i(v,c,r);N<R;){for(i(v,N,R),N++,R--;p(v[N],F)<0;)N++;for(;p(v[R],F)>0;)R--}p(v[c],F)===0?i(v,c,R):i(v,++R,r),R<=n&&(c=R+1),n<=R&&(r=R-1)}})(s,a,A||0,m||s.length-1,f||q)}function i(s,a,A){var m=s[a];s[a]=s[A],s[A]=m}function q(s,a){return s<a?-1:s>a?1:0}var l=function(s){s===void 0&&(s=9),this._maxEntries=Math.max(4,s),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function x(s,a,A){if(!A)return a.indexOf(s);for(var m=0;m<a.length;m++)if(A(s,a[m]))return m;return-1}function E(s,a){k(s,0,s.children.length,a,s)}function k(s,a,A,m,f){f||(f=C(null)),f.minX=1/0,f.minY=1/0,f.maxX=-1/0,f.maxY=-1/0;for(var y=a;y<A;y++){var v=s.children[y];X(f,s.leaf?m(v):v)}return f}function X(s,a){return s.minX=Math.min(s.minX,a.minX),s.minY=Math.min(s.minY,a.minY),s.maxX=Math.max(s.maxX,a.maxX),s.maxY=Math.max(s.maxY,a.maxY),s}function Y(s,a){return s.minX-a.minX}function W(s,a){return s.minY-a.minY}function g(s){return(s.maxX-s.minX)*(s.maxY-s.minY)}function w(s){return s.maxX-s.minX+(s.maxY-s.minY)}function b(s,a){return s.minX<=a.minX&&s.minY<=a.minY&&a.maxX<=s.maxX&&a.maxY<=s.maxY}function M(s,a){return a.minX<=s.maxX&&a.minY<=s.maxY&&a.maxX>=s.minX&&a.maxY>=s.minY}function C(s){return{children:s,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function T(s,a,A,m,f){for(var y=[a,A];y.length;)if(!((A=y.pop())-(a=y.pop())<=m)){var v=a+Math.ceil((A-a)/m/2)*m;o(s,v,a,A,f),y.push(a,v,v,A)}}return l.prototype.all=function(){return this._all(this.data,[])},l.prototype.search=function(s){var a=this.data,A=[];if(!M(s,a))return A;for(var m=this.toBBox,f=[];a;){for(var y=0;y<a.children.length;y++){var v=a.children[y],n=a.leaf?m(v):v;M(s,n)&&(a.leaf?A.push(v):b(s,n)?this._all(v,A):f.push(v))}a=f.pop()}return A},l.prototype.collides=function(s){var a=this.data;if(!M(s,a))return!1;for(var A=[];a;){for(var m=0;m<a.children.length;m++){var f=a.children[m],y=a.leaf?this.toBBox(f):f;if(M(s,y)){if(a.leaf||b(s,y))return!0;A.push(f)}}a=A.pop()}return!1},l.prototype.load=function(s){if(!s||!s.length)return this;if(s.length<this._minEntries){for(var a=0;a<s.length;a++)this.insert(s[a]);return this}var A=this._build(s.slice(),0,s.length-1,0);if(this.data.children.length)if(this.data.height===A.height)this._splitRoot(this.data,A);else{if(this.data.height<A.height){var m=this.data;this.data=A,A=m}this._insert(A,this.data.height-A.height-1,!0)}else this.data=A;return this},l.prototype.insert=function(s){return s&&this._insert(s,this.data.height-1),this},l.prototype.clear=function(){return this.data=C([]),this},l.prototype.remove=function(s,a){if(!s)return this;for(var A,m,f,y=this.data,v=this.toBBox(s),n=[],c=[];y||n.length;){if(y||(y=n.pop(),m=n[n.length-1],A=c.pop(),f=!0),y.leaf){var r=x(s,y.children,a);if(r!==-1)return y.children.splice(r,1),n.push(y),this._condense(n),this}f||y.leaf||!b(y,v)?m?(A++,y=m.children[A],f=!1):y=null:(n.push(y),c.push(A),A=0,m=y,y=y.children[0])}return this},l.prototype.toBBox=function(s){return s},l.prototype.compareMinX=function(s,a){return s.minX-a.minX},l.prototype.compareMinY=function(s,a){return s.minY-a.minY},l.prototype.toJSON=function(){return this.data},l.prototype.fromJSON=function(s){return this.data=s,this},l.prototype._all=function(s,a){for(var A=[];s;)s.leaf?a.push.apply(a,s.children):A.push.apply(A,s.children),s=A.pop();return a},l.prototype._build=function(s,a,A,m){var f,y=A-a+1,v=this._maxEntries;if(y<=v)return E(f=C(s.slice(a,A+1)),this.toBBox),f;m||(m=Math.ceil(Math.log(y)/Math.log(v)),v=Math.ceil(y/Math.pow(v,m-1))),(f=C([])).leaf=!1,f.height=m;var n=Math.ceil(y/v),c=n*Math.ceil(Math.sqrt(v));T(s,a,A,c,this.compareMinX);for(var r=a;r<=A;r+=c){var p=Math.min(r+c-1,A);T(s,r,p,n,this.compareMinY);for(var u=r;u<=p;u+=n){var S=Math.min(u+n-1,p);f.children.push(this._build(s,u,S,m-1))}}return E(f,this.toBBox),f},l.prototype._chooseSubtree=function(s,a,A,m){for(;m.push(a),!a.leaf&&m.length-1!==A;){for(var f=1/0,y=1/0,v=void 0,n=0;n<a.children.length;n++){var c=a.children[n],r=g(c),p=(u=s,S=c,(Math.max(S.maxX,u.maxX)-Math.min(S.minX,u.minX))*(Math.max(S.maxY,u.maxY)-Math.min(S.minY,u.minY))-r);p<y?(y=p,f=r<f?r:f,v=c):p===y&&r<f&&(f=r,v=c)}a=v||a.children[0]}var u,S;return a},l.prototype._insert=function(s,a,A){var m=A?s:this.toBBox(s),f=[],y=this._chooseSubtree(m,this.data,a,f);for(y.children.push(s),X(y,m);a>=0&&f[a].children.length>this._maxEntries;)this._split(f,a),a--;this._adjustParentBBoxes(m,f,a)},l.prototype._split=function(s,a){var A=s[a],m=A.children.length,f=this._minEntries;this._chooseSplitAxis(A,f,m);var y=this._chooseSplitIndex(A,f,m),v=C(A.children.splice(y,A.children.length-y));v.height=A.height,v.leaf=A.leaf,E(A,this.toBBox),E(v,this.toBBox),a?s[a-1].children.push(v):this._splitRoot(A,v)},l.prototype._splitRoot=function(s,a){this.data=C([s,a]),this.data.height=s.height+1,this.data.leaf=!1,E(this.data,this.toBBox)},l.prototype._chooseSplitIndex=function(s,a,A){for(var m,f,y,v,n,c,r,p=1/0,u=1/0,S=a;S<=A-a;S++){var B=k(s,0,S,this.toBBox),d=k(s,S,A,this.toBBox),L=(f=B,y=d,v=void 0,n=void 0,c=void 0,r=void 0,v=Math.max(f.minX,y.minX),n=Math.max(f.minY,y.minY),c=Math.min(f.maxX,y.maxX),r=Math.min(f.maxY,y.maxY),Math.max(0,c-v)*Math.max(0,r-n)),P=g(B)+g(d);L<p?(p=L,m=S,u=P<u?P:u):L===p&&P<u&&(u=P,m=S)}return m||A-a},l.prototype._chooseSplitAxis=function(s,a,A){var m=s.leaf?this.compareMinX:Y,f=s.leaf?this.compareMinY:W;this._allDistMargin(s,a,A,m)<this._allDistMargin(s,a,A,f)&&s.children.sort(m)},l.prototype._allDistMargin=function(s,a,A,m){s.children.sort(m);for(var f=this.toBBox,y=k(s,0,a,f),v=k(s,A-a,A,f),n=w(y)+w(v),c=a;c<A-a;c++){var r=s.children[c];X(y,s.leaf?f(r):r),n+=w(y)}for(var p=A-a-1;p>=a;p--){var u=s.children[p];X(v,s.leaf?f(u):u),n+=w(v)}return n},l.prototype._adjustParentBBoxes=function(s,a,A){for(var m=A;m>=0;m--)X(a[m],s)},l.prototype._condense=function(s){for(var a=s.length-1,A=void 0;a>=0;a--)s[a].children.length===0?a>0?(A=s[a-1].children).splice(A.indexOf(s[a]),1):this.clear():E(s[a],this.toBBox)},l})})(Es);var hc=Es.exports,mc=ot&&ot.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(se,"__esModule",{value:!0});se.System=void 0;const Wt=Rt,fc=mc(hc),H=tt,Bt=ut(),yc=Ft,gc=Ot,vc=vt,ue=Ut(),wc=co(),Sc=Zt;class xc extends fc.default{constructor(){super(...arguments),this.response=new H.Response}draw(e){this.all().forEach(o=>{o.draw(e)})}drawBVH(e){this.data.children.forEach(({minX:o,maxX:i,minY:q,maxY:l})=>{ue.Polygon.prototype.draw.call({pos:{x:o,y:q},calcPoints:(0,Bt.createBox)(i-o,l-q)},e)}),this.all().forEach(o=>{const{pos:i,w:q,h:l}=o.getAABBAsBox();ue.Polygon.prototype.draw.call({pos:i,calcPoints:(0,Bt.createBox)(q,l)},e)})}updateBody(e){this.remove(e),e.updateAABB(),this.insert(e)}remove(e,o){return e.system=void 0,super.remove(e,o)}insert(e){return e.system=this,super.insert(e)}update(){this.all().forEach(e=>{e.isStatic||this.updateBody(e)})}separate(){this.checkAll(e=>{e.a.isTrigger||(e.a.pos.x-=e.overlapV.x,e.a.pos.y-=e.overlapV.y,this.updateBody(e.a))})}checkOne(e,o){e.isStatic||this.getPotentials(e).forEach(i=>{this.checkCollision(e,i)&&o(this.response)})}checkAll(e){this.all().forEach(o=>{this.checkOne(o,e)})}getPotentials(e){return this.search(e).filter(o=>o!==e)}checkCollision(e,o){if(this.response.clear(),e.type===H.Types.Circle&&o.type===H.Types.Circle)return(0,Wt.testCircleCircle)(e,o,this.response);if(e.type===H.Types.Circle&&o.type!==H.Types.Circle)return(0,Wt.testCirclePolygon)(e,o,this.response);if(e.type!==H.Types.Circle&&o.type===H.Types.Circle)return(0,Wt.testPolygonCircle)(e,o,this.response);if(e.type!==H.Types.Circle&&o.type!==H.Types.Circle)return(0,Wt.testPolygonPolygon)(e,o,this.response);throw Error("Not implemented")}raycast(e,o,i=()=>!0){let q=1/0,l=null;const x=this.createLine(e,o),E=this.getPotentials(x).filter(k=>i(k)&&this.checkCollision(x,k));return this.remove(x),E.forEach(k=>{(k.type===H.Types.Circle?(0,Bt.intersectLineCircle)(x,k):(0,Bt.intersectLinePolygon)(x,k)).forEach(Y=>{const W=(0,Bt.distance)(e,Y);W<q&&(q=W,l={point:Y,collider:k})})}),l}createPoint(e){const o=new yc.Point(e);return this.insert(o),o}createLine(e,o,i=0){const q=new wc.Line(e,o);return q.setAngle(i),this.insert(q),q}createCircle(e,o){const i=new gc.Circle(e,o);return this.insert(i),i}createBox(e,o,i,q=0){const l=new vc.Box(e,o,i);return l.setAngle(q),this.insert(l),l}createEllipse(e,o,i,q,l=0){const x=new Sc.Ellipse(e,o,i,q);return x.setAngle(l),this.insert(x),x}createPolygon(e,o,i=0){const q=new ue.Polygon(e,o);return q.setAngle(i),this.insert(q),q}}se.System=xc;(function(t){var e=ot&&ot.__createBinding||(Object.create?function(i,q,l,x){x===void 0&&(x=l);var E=Object.getOwnPropertyDescriptor(q,l);(!E||("get"in E?!q.__esModule:E.writable||E.configurable))&&(E={enumerable:!0,get:function(){return q[l]}}),Object.defineProperty(i,x,E)}:function(i,q,l,x){x===void 0&&(x=l),i[x]=q[l]}),o=ot&&ot.__exportStar||function(i,q){for(var l in i)l!=="default"&&!Object.prototype.hasOwnProperty.call(q,l)&&e(q,i,l)};Object.defineProperty(t,"__esModule",{value:!0}),o(tt,t),o(Ot,t),o(Zt,t),o(Ut(),t),o(vt,t),o(Ft,t),o(co(),t),o(se,t),o(ut(),t)})(io);const ht=new io.System,Cs=t=>{ht.insert(t),ht.updateBody(t)},Ct=t=>{ht.remove(t)},U=(t,e,o)=>{const i=new io.Box(t,e,o);return Cs(i),i};let Ls;const Ms=()=>Ls,Bc=()=>{Ls=U({x:0,y:0},2,2)},kc=()=>{const t=Ms();ht.getPotentials(t).forEach(e=>{ht.checkCollision(t,e)&&bc(ht.response)})},bc=t=>{t.aInB&&(t.overlapV.x&&yt(qt()-t.overlapV.x),t.overlapV.y&&gt(dt()-t.overlapV.y))},Ec=()=>{var t;(t=Ms())==null||t.setPosition(Ne(),De()),kc()},Cc=t=>{if(t){Zo.start();return}Zo.stop()},Zo=new j({callback:Ec,fps:60}),Lc=()=>{J.subscribe(Cc)};let Pe;const Mc=t=>{Pe=t};let Ps;const Pc=()=>{const t=Pe[$a(0,Pe.length)];h.play(t)},Ic=()=>{Ps=setInterval(Pc,4e4)},Yc=()=>{clearInterval(Ps)},Is=document.getElementById("mouseLockHint"),Ys=()=>{Is.classList.remove("hidden")},Xs=()=>{Is.classList.add("hidden")},Xc=100,Ts=200;let Pt,Ie=Ts,lo=!0;const Tc=()=>{lo=!0},Rc=()=>{lo=!1},Oc=()=>{lo&&h.play("playerSteps1")},Rs=()=>{Pt=setInterval(Oc,Ie)},Os=()=>{clearInterval(Pt),Pt=void 0},Uc=t=>{if(t){if(Pt!==void 0)return;Rs()}else Os()},Zc=t=>{t?Ie=Xc:Ie=Ts,Pt&&(Os(),Rs())};J.subscribe(Uc);so.subscribe(Zc);const Ao=new st,qo=document.querySelector("#room1 .wallBtnWrap"),Us=document.getElementById("monster-face"),Fc=document.getElementById("monster-face-wrap");Us.addEventListener("animationend",t=>{t.target.remove()});const Qc=()=>{nt("room1WallBtn"),Fs(),Z()},Zs=t=>{t.code==="KeyE"&&(qo.classList.add("pressed"),h.play("wall_btn_press"),Qc(),Ao.broadcast(),Fc.style.transform=`rotateY(${-Qe()}deg)`,Us.classList.add("show"),h.play("scream-sound"))},Nc=()=>{qo.classList.add("active"),document.addEventListener("keydown",Zs),$("press E")},Fs=()=>{qo.classList.remove("active"),document.removeEventListener("keydown",Zs),Z()};Q("room1WallBtn",{isActive:!1,maxX:1900,minX:1350,maxZ:650,minZ:350,activationCallback:Nc,deactivationCallback:Fs});const Qs=new st,uo=document.querySelector("#room5 .wallBtnWrap"),Dc=()=>{nt("room5WallBtn"),Ds(),Z()},Ns=t=>{t.code==="KeyE"&&(uo.classList.add("pressed"),h.play("wall_btn_press"),setTimeout(()=>{h.play("glassWallSound")},500),Dc(),Qs.broadcast())},Wc=()=>{uo.classList.add("active"),document.addEventListener("keydown",Ns),$("press E")},Ds=()=>{uo.classList.remove("active"),document.removeEventListener("keydown",Ns),Z()};Q("room5WallBtn",{isActive:!1,maxX:950,minX:600,maxZ:3600,minZ:3350,activationCallback:Wc,deactivationCallback:Ds});U({x:-800,y:-650},2800,200);U({x:-700,y:-730},200,4500);U({x:910,y:600},200,500);const Gc=U({x:950,y:260},-500,100),Vc=U({x:440,y:260},100,700),zc=U({x:440,y:850},550,100),Kc=()=>{Ct(Gc),Ct(Vc),Ct(zc)};U({x:1800,y:-730},200,1500);U({x:2e3,y:600},-1200,200);U({x:900,y:800},200,-900);const Ws=U({x:900,y:-600},200,800),Hc=()=>{Ct(Ws)},jc=()=>{Cs(Ws)};U({x:2100,y:1e3},200,1600);U({x:2200,y:2400},-1250,100);U({x:2200,y:1e3},-1250,100);const Jc=U({x:920,y:1e3},200,1600),_c=()=>{Ct(Jc)};Qs.subscribe(_c);U({x:920,y:2400},200,1300);U({x:-600,y:3550},1600,200);const $c=U({x:-600,y:2650},1600,300),tl=()=>{$c.setPosition(-200,2650)};Ao.subscribe(tl);Mc(["lvlBg1","lvlBg2","lvlBg3","lvlBg4"]);const Gs=t=>{t?Ys():Xs()},el=()=>{lt.subscribe(Gs)},ol=()=>{lt.unsubscribe(Gs)},nl=({x:t,y:e,z:o,angleX:i,angleY:q})=>{yt(t),Fe(e),gt(o),pa({x:t,y:e,z:o}),no({movementX:i,movementY:q})},sl=800,rl=16,al=687,il=0,cl=0;nl({x:sl,y:rl,z:al,angleX:il,angleY:cl});const ll=document.getElementById("healSpell"),Fo=70,Al=()=>{document.addEventListener("keydown",Vs)},ql=()=>{document.removeEventListener("keydown",Vs)},dl=()=>{ll.animate([{opacity:.5},{opacity:1},{opacity:.5}],{duration:500})},Vs=t=>{if(t.code==="KeyT"){if(Dn()<Fo){Nn(),h.play("notEnoughMana");return}Wn(Fo),Na(40),dl(),h.play("healSpell")}},ul=document.getElementById("healSpell"),po=document.querySelector("#room2 .spell1"),ho=t=>{t.code==="KeyE"&&(document.removeEventListener("keydown",ho),nt("room2HealSpell"),Z(),po.remove(),ul.classList.remove("hide"),h.play("pickingSpell"),Al())},pl=()=>{po.style.filter="brightness(0.8)",document.addEventListener("keydown",ho),$("press E")},hl=()=>{po.style.filter="brightness(0.5)",document.removeEventListener("keydown",ho),Z()};Q("room2HealSpell",{isActive:!1,maxX:0,minX:-550,maxZ:50,minZ:-570,activationCallback:pl,deactivationCallback:hl});const _t=new Map,zs=document.getElementById("lvlTaskWrap"),ml=zs.getElementsByClassName("lvlTaskList")[0],fl=()=>{zs.classList.remove("hide")},yl=()=>{_t.forEach(t=>{t.elem.remove()}),_t.clear()},Ks=(t,e)=>{const o=document.createElement("li");o.textContent=e,_t.set(t,{title:e,elem:o}),ml.append(o)},gl=t=>{t.forEach(([e,o])=>{Ks(e,o)})},vl=t=>{var e;(e=_t.get(t))==null||e.elem.classList.add("done")},Hs=document.querySelector("#room2 .scroll1");let js=!1;const Js=t=>{t.code==="KeyQ"&&(Z(),window.removeEventListener("keydown",Js),oe())},mo=t=>{if(t.code!=="KeyE")return;Ln("room2Scroll");const e=rs();e.style.filter="brightness(0.8) hue-rotate(140deg)",as(`Further is a magic wall with portal behind it, somewhere 
  in this tunnels must be a way to reach it. I think I saw a light coming 
  from a crack near one of the walls. I wish you luck, it seems to me I 
  will stay here for ever...`),is(),Z(),$("press Q"),window.addEventListener("keydown",Js),window.removeEventListener("keydown",mo),js||wl()},wl=()=>{vl("blueScroll"),Ks("main","find the way out"),js=!0,h.play("taskDone")},Sl=()=>{Hs.classList.add("active"),window.addEventListener("keydown",mo),$("press E")},xl=()=>{Hs.classList.remove("active"),window.removeEventListener("keydown",mo),Z()};Q("room2Scroll",{isActive:!1,maxZ:800,minZ:200,maxX:-100,minX:-500,activationCallback:Sl,deactivationCallback:xl});const _s=()=>{h.loop("torch1",!0),h.play("torch1")},$s=()=>{h.loop("torch1",!1),h.stop("torch1")};Q("room2Torch",{isActive:!1,maxX:450,minX:-150,maxZ:-200,minZ:-500,activationCallback:_s,deactivationCallback:$s});const fo=()=>{h.loop("bugSound1",!0),h.play("bugSound1")},yo=()=>{h.loop("bugSound1",!1),h.stop("bugSound1")};Q("room2WallBug",{isActive:!1,maxX:950,minX:600,maxZ:250,minZ:-100,activationCallback:fo,deactivationCallback:yo});const Qo=50,tr=document.getElementById("bugSpell");let go=!1;const Bl=()=>{document.addEventListener("keydown",er)},kl=()=>{document.removeEventListener("keydown",er)},er=t=>{t.code==="KeyR"&&(go?bl():El())},bl=()=>{go=!1,h.play("transformSpell"),Fe(16),tr.style.opacity="0.5",Tc(),Bs(),Yn(),oe(),jc(),_e()&&Jn()},El=()=>{if(Dn()<Qo){Nn(),h.play("notEnoughMana");return}go=!0,h.play("transformSpell"),Wn(Qo),Fe(-420),tr.style.opacity="1",Rc(),ks(),Fa(),Mn(),Oa(),Hc(),_e()&&bi()},Cl=document.getElementById("room1"),Ll=document.getElementById("room3"),Ml=document.getElementById("room5"),Pl=new Map([["room1",{isActive:!1,el:Cl,coords:{minX:600,maxX:1900,minZ:-530,maxZ:700}}],["room3",{isActive:!1,el:Ll,coords:{minX:420,maxX:2200,minZ:1e3,maxZ:2450}}],["room5",{isActive:!1,el:Ml,coords:{minX:-600,maxX:950,minZ:2250,maxZ:3600}}]]);let Ye,Xe;const Il=()=>{Ye=Ne(),Xe=De()},Yl=()=>{for(const t of Pl.values())if(Xe<=t.coords.maxZ&&Xe>=t.coords.minZ&&Ye<=t.coords.maxX&&Ye>=t.coords.minX){if(t.isActive)return;t.isActive=!0,t.el.classList.remove("optimizeRender")}else t.isActive&&(t.isActive=!1,t.el.classList.add("optimizeRender"))},Xl=()=>{Il(),Yl()},or=new j({callback:Xl,fps:10}),Tl=()=>{or.start()},Rl=()=>{or.stop()},nr=document.getElementById("lvl1EndScreen"),sr=nr.querySelector(".close"),Ol=()=>{yl(),Rl(),ol(),Xs(),ai(),Ke(),Tt(!1),kl(),ql(),ts(),yi(),Yc(),nr.classList.remove("hide"),h.loop("lvlEnd",!0),h.play("lvlEnd")},Ul=()=>{h.play("menuButtonClick"),location.reload()},Zl=()=>{ft.play("menuButtonHover")};sr.addEventListener("mouseover",Zl);sr.addEventListener("click",Ul);const Fl=()=>{h.loop("portalRoomSound",!0),h.play("portalRoomSound")},rr=()=>{h.loop("portalRoomSound",!1),h.stop("portalRoomSound")};Q("room3portalRoomSound",{isActive:!1,maxX:2200,minX:950,maxZ:2500,minZ:1050,activationCallback:Fl,deactivationCallback:rr});const Ql=()=>{rr(),Ol()};Q("room3PortalEntering",{isActive:!1,maxX:2250,minX:2050,maxZ:2250,minZ:1300,activationCallback:Ql,deactivationCallback:()=>{}});const ar=document.querySelector("#room3 .scroll1"),ir=t=>{t.code==="KeyQ"&&(Z(),window.removeEventListener("keydown",ir),oe())},vo=t=>{if(t.code!=="KeyE")return;const e=rs();e.style.filter="brightness(0.8) hue-rotate(260deg)",Ln("room3Scroll"),as("further danger awaits you, better find some weapon and heal your wounds"),is(),Z(),$("press Q"),window.addEventListener("keydown",ir),window.removeEventListener("keydown",vo)},Nl=()=>{ar.classList.add("active"),window.addEventListener("keydown",vo),$("press E")},Dl=()=>{ar.classList.remove("active"),window.removeEventListener("keydown",vo),Z()};Q("room3Scroll",{isActive:!1,maxZ:2e3,minZ:1400,maxX:1600,minX:1100,activationCallback:Nl,deactivationCallback:Dl});const cr=document.querySelector("#room3 .protectionOpacityWall"),Wl=()=>{cr.style.webkitMaskImage="radial-gradient(transparent 0%, black 15%)"},Gl=()=>{cr.style.webkitMaskImage="radial-gradient(transparent 0%, black 0%)"};Q("secretWallFar",{isActive:!1,maxX:900,minX:450,maxZ:2100,minZ:1300,activationCallback:Wl,deactivationCallback:Gl});const Vl=document.getElementById("bugSpell"),wo=document.querySelector("#room4 .spell1"),So=t=>{t.code==="KeyE"&&(document.removeEventListener("keydown",So),nt("room4BugSpell"),Z(),wo.remove(),Vl.classList.remove("hide"),h.play("pickingSpell"),Bl())},zl=()=>{wo.style.filter="brightness(0.8)",document.addEventListener("keydown",So),$("press E")},Kl=()=>{wo.style.filter="brightness(0.5)",document.removeEventListener("keydown",So),Z()};Q("room4BugSpell",{isActive:!1,maxX:100,minX:-550,maxZ:2300,minZ:1300,activationCallback:zl,deactivationCallback:Kl});Q("room5FloorBug",{isActive:!1,maxX:450,minX:-100,maxZ:3250,minZ:2900,activationCallback:fo,deactivationCallback:yo});Q("room5ShieldBug",{isActive:!1,maxX:950,minX:750,maxZ:3250,minZ:2900,activationCallback:fo,deactivationCallback:yo});Q("room5Torch",{isActive:!1,maxX:-150,minX:-500,maxZ:3500,minZ:2500,activationCallback:_s,deactivationCallback:$s});const Hl=document.querySelector("#room5 .bulkWallWrap"),jl=()=>{Hl.classList.add("open"),setTimeout(()=>{h.play("wall_opening")},1500)};Ao.subscribe(jl);const Jl=document.getElementById("camera"),_l=()=>{Jl.style.transform=`
    rotateX(${dn()}deg) 
    rotateY(${Qe()}deg) 
    translateX(${qt()}px) 
    translateZ(${dt()}px)
    translateY(${la()}px)
  `},$l=new j({callback:_l,fps:30}),tA=()=>{$l.start()},eA=document.getElementById("scenesWrap");let pe,he,me,fe,ye,ge;const oA=()=>{fe=Ji(),ye=ao(),ge=_i(),!(pe===fe&&he===ye&&me===ge)&&(pe=fe,he=ye,me=ge,eA.style.transform=`
    translateX(${pe}px) 
    translateZ(${me}px)
    translateY(${he}px)
    rotateY(180deg)
  `)},nA=new j({callback:oA,fps:10}),sA=()=>{nA.start()},re=document.getElementById("sceneScreen"),rA=()=>{re.classList.remove("transparent")},lr=()=>{re.classList.add("transparent")},aA=()=>re,iA=()=>{re.remove()},ve=document.querySelector("#room2 .bugWrap2"),cA=()=>{ve.classList.add("moving","move"),ve.addEventListener("animationend",()=>{ve.classList.remove("moving")})},we="rotateX(270deg) rotateY(0deg) translateX(800px) translateZ(687px) translateY(-360px)",No="rotateX(330deg) rotateY(0deg) translateX(800px) translateZ(687px) translateY(-180px)",Do="rotateX(330deg) rotateY(-50deg) translateX(800px) translateZ(687px) translateY(-180px)",Wo="rotateX(330deg) rotateY(35deg) translateX(800px) translateZ(687px) translateY(-180px)",Go="rotateX(300deg) rotateY(65deg) translateX(800px) translateZ(687px) translateY(-180px)",Vo="rotateX(288deg) rotateY(0deg) translateX(800px) translateZ(687px) translateY(-180px)",zo="rotateX(288deg) rotateY(0deg) translateX(800px) translateZ(687px) translateY(16px)",lA="rotateX(360deg) rotateY(0deg) translateX(800px) translateZ(687px) translateY(16px)",AA=document.getElementById("camera"),et=(t,e,o)=>AA.animate([{transform:t},{transform:e}],{duration:o,easing:"ease"}).finished,qA=t=>aA().animate([{backgroundColor:"black"},{backgroundColor:"transparent"}],{duration:t,easing:"ease",fill:"forwards"}).finished,dA=async()=>{qA(2e3),await et(we,we,1e3),await et(we,No,2e3),await et(No,Do,3e3),await et(Do,Wo,3e3),await et(Wo,Go,1e3),await et(Go,Vo,1e3),await et(Vo,zo,1e3),cA(),await et(zo,lA,1e3),lr()},uA=()=>{tA(),sA(),Bc(),Lc(),Ys(),Tl(),Di(),gl([["blueScroll","read blue scroll"]]),fl(),Qa(40),hi(0)},pA=async()=>{ri(),Xt(),h.play("awakeningOST"),await dA(),Yn(),el(),ec(),Tt(ns()),di(),fi(),ca(),Ic(),iA()},Ar=document.getElementById("gameSection"),Ko=()=>{Ar.classList.remove("hide")},hA=()=>{Ar.classList.add("hide")},xo=document.getElementById("graphicModeSwitch");let Bo="low";const mA=()=>{nt("room2WallBug"),Kc(),nt("room5FloorBug"),nt("room5ShieldBug")},fA=()=>{Bo==="low"?document.body.classList.add("lowGraphic"):document.body.classList.remove("lowGraphic")},yA=()=>{Bo==="low"&&mA()},qr=t=>{Bo=t,fA()},gA=t=>{var e;(e=document.querySelector(`#graphicModeSwitch button[data-graphicmode="${t}"]`))==null||e.classList.add("selected"),qr(t)},vA=({target:t})=>{t.tagName==="BUTTON"&&(t.classList.contains("selected")||(h.play("menuButtonClick"),xo.querySelector(".selected").classList.remove("selected"),t.classList.add("selected"),qr(t.dataset.graphicmode)))},wA=({target:t})=>{t.tagName==="BUTTON"&&ft.play("menuButtonHover")};xo.addEventListener("click",vA);xo.addEventListener("mouseover",wA);const Qt=document.getElementById("menu"),Ho=()=>{Qt.classList.add("hide"),h.loop("menuBg",!1),h.stop("menuBg")},SA=()=>{Qt.remove()},dr=()=>{h.loop("menuBg",!0),h.play("menuBg"),Qt.classList.remove("hide")},xA=({target:t})=>{t.classList.contains("menu_button")&&ft.play("menuButtonHover")},Te=()=>{window.removeEventListener("keydown",Te),aa(),dr(),Vt(),hA(),rA(),Ke()},BA=({target:t})=>{if(!t.classList.contains("menu_button"))return;const e=t.dataset.action;switch(h.play("menuButtonClick"),e){case"startGame":{Se("Explore your surroundings carefully"),xe(),ko(),Ko(),Ho(),Yi(),yA(),uA(),setTimeout(()=>{Vt(),pA(),setTimeout(()=>{gr(),SA(),document.getElementById("aboutSection").remove()},600)},1e3);return}case"openControlsSubPanel":{Lt("controlsSection");return}case"openAboutSubPanel":{Lt("aboutSection");return}case"startFpsTour":{Se("press Esc to return to the menu"),xe(),ko(),Ko(),Ho(),setTimeout(()=>{const o=ra();Vt(),lr(),o.onfinish=Te,window.addEventListener("keydown",Te),Xt()},1e3);return}default:throw"menu button with unknown action"}};Qt.addEventListener("click",BA);Qt.addEventListener("mouseover",xA);document.querySelector(".menu_button.flicker").addEventListener("click",({target:t})=>{t.classList.remove("flicker")},{once:!0});const kA=()=>{"ontouchstart"in window&&Lt("touchScreenMSG")},bA=()=>{dr(),kA(),Vt(),yr(),fr()},EA=()=>{mr(),Se("click to continue"),xe(),window.addEventListener("click",bA,{once:!0})};window.addEventListener("load",EA);const CA=t=>{t.preventDefault()};window.addEventListener("contextmenu",CA);const ae=new st,LA=t=>{const e=MA(t.newRealAngleY),o=At(t.newNormalizedAngleX),i=PA(t.newRealAngleY,e,t.newNormalizedAngleY);Aa(t.newRealAngleX),qa(e),da(o),ua(i),ae.broadcast()},jo=60,Jo=-60,MA=t=>t>jo?jo:t<Jo?Jo:t,PA=(t,e,o)=>t!==e?un():At(o);oo.subscribe(LA);const IA=()=>{const{x:t,z:e}=eo(At($t()-180));Sa(t),xa(e)};ae.subscribe(IA);const YA=()=>{const{x:t,z:e}=eo(At($t()));va(t),wa(e)};ae.subscribe(YA);const XA=()=>{const{x:t,z:e}=eo(At($t()-90));Ba(t),ka(e)};ae.subscribe(XA);let Re,Oe;const TA=()=>{document.documentElement.requestFullscreen?(Re=()=>document.documentElement.requestFullscreen(),Oe=()=>document.exitFullscreen()):(Re=()=>document.documentElement.webkitRequestFullscreen(),Oe=()=>document.webkitExitFullscreen()),lt.subscribe(t=>{t?RA():OA()})},RA=()=>{Re()},OA=()=>{Oe()};TA();Kn();gA("low");
